/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nvar _Giraff = __webpack_require__(/*! ./partials/Giraff.js */ \"./partials/Giraff.js\");\n\nvar _Giraff2 = _interopRequireDefault(_Giraff);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(function (version, config) {\n    window.giraff ? null : window.giraff = {};\n\n    if (typeof window.giraff[config.name] != 'undefined') {\n        return;\n    }\n\n    window.giraff[config.name] = new _Giraff2.default(version, config);\n\n    window.grf_change_article = function (url, elem, is_canonical, ftrack_id) {\n        window.giraff[ftrack_id ? ftrack_id : config.name].change_article(url, elem, is_canonical);\n        window.giraff[ftrack_id ? ftrack_id : config.name].stats.clear_stats();\n    };\n\n    window.grf_run_widget = function (cb_name, options, ftrack_id) {\n        window.giraff[ftrack_id ? ftrack_id : config.name].callback_name = cb_name;\n        window.giraff[ftrack_id ? ftrack_id : config.name].callback_options = options;\n        window.giraff[ftrack_id ? ftrack_id : config.name].parent.postMessage(\"giraff:get_config\", \"*\");\n    };\n\n    var history = window.history;\n    var oldPushState = history.pushState.bind(history);\n    history.pushState = function (state, title, url) {\n        window.giraff[config.name].stats.clear_stats();\n        return oldPushState(state, title, url);\n    };\n})( true ? 20180605174504 : undefined,  true ? {\"widgets\": [{\"cells\": [\"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\", \"ps\"], \"rev\": {\"fill\": 30, \"id\": 1940900}, \"cols\": 4, \"ae\": {\"fill\": 70, \"id\": 1940896}, \"tpl\": {\"item\": \"<div class=\\\"grf-list__item\\\" data-type=\\\"%CELL_TYPE%\\\">\\r\\n    <a target=\\\"%TARGET%\\\" class=\\\"grf-list__link\\\" href=\\\"%URL%\\\">\\r\\n        <div class=\\\"grf-list__link-img\\\">\\r\\n            <img class=\\\"grf-list__img\\\" src=\\\"%IMG_300x200%\\\"/>\\r\\n        </div>\\r\\n        <div class=\\\"grf-list__link-title\\\">\\r\\n            <div class=\\\"grf-list__title\\\">%TITLE%</div>\\r\\n            <div class=\\\"grf-list__ads\\\">\\u0420\\u0435\\u043a\\u043b\\u0430\\u043c\\u0430</div>\\r\\n            <div class=\\\"grf-list__announce\\\">%ANNOUNCE%</div>\\r\\n        </div>\\r\\n    </a>\\r\\n</div>\", \"footer\": \"</div>\\r\\n    <div class=\\\"grf-widget__logo\\\">\\r\\n        <a href=\\\"https://giraff.io/\\\" class=\\\"grf-widget__logo-link\\\" target=\\\"_blank\\\"></a>\\r\\n    </div>\\r\\n</div>\", \"row_footer\": \"\", \"row_header\": \"\", \"css\": \"<style>.grf-widget--%ADP_ID% {\\r\\n    font-size: 15px;\\r\\n\\tfont-family: Arial, Helvetica, sans-serif;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-widget__heading{\\r\\n\\tfont: 20px HelveticaNeueCyr-Medium;\\r\\n    overflow: hidden;\\r\\n\\tcolor: #111;\\r\\n    padding: 15px 0;\\r\\n    border-top: 2px solid #41464b;\\r\\n\\tmargin-top: 10px;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-widget__logo {\\r\\n    text-align: right;\\r\\n    margin-top: 10px;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-widget__logo-link {\\r\\n    position: relative;\\r\\n    width: 50px;\\r\\n    height: 16px;\\r\\n    display: inline-block;\\r\\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAgCAMAAADT9S0cAAAAIVBMVEUAAABJSV1JSV1ISFxMTGBLS15JSV1JSV1RUWJJSV1KSl22InlGAAAAC3RSTlMAzGWYIjR/vQ2oSrJWohQAAAHySURBVHgBtZPrkupACIRpYLjw/g98IpnUZnPRPValf4hFHL9MN9BONeh5uTwMGMb6PASLcsSzFEFjnoXESnk4e26IfGs321hKFJt+hMD0GxtsfT9NAPwOIqPasnuK5M0zg/MIikT2spXzDQRJFCV+C4m7yBTQ+RcxoXI3xEL8Pne9eVyQrrZZFRV0rdL4crgY1jVRn8ILGo9DGBUyrl0aQcOLIoj6Y5S+vi39eVRUNSjBS+0j3e9fHCC+NWTRD0KwyFyUEkqBjASSRmKR6G7FsisTFWwO9mGixw0kYToETkSOQQpPiBUxxMz7ECOZeVDClqrTv0i4CSCHUEpPkIJsdk8IfDW1vXPwKZPZsB5o9f1dxujgjxADb2WD8C+T5Q7iGNtb8qK58WT3kHmsIfrb5BuIAtum7iBOdQHh8002e8tE8g3ELyAo4lMmcx7CoQcIA2Jm/wvpeoB0fsxrenuIwvWPdvnergjREyTEBciiA6Qga/EPwfM++KXkRSY1L3iCtBvqJ4jWbDBSiYajdpBSXEKcS+MEUUDYIEdIAGM2EpBE8zZIMWXGVSYvJb/6HhSek+6Ac7j83NbW6dDZCAPgRZ9VyDGKHUIHhY6gs2LfVKU/KHqC5ww/JUV27aF4TECtriGegxQgxtKs56SW7mlK3+sfjcMN2mXq80UAAAAASUVORK5CYII=');\\r\\n    -moz-background-size: 100%;\\r\\n    -o-background-size: 100%;\\r\\n    background-size: 100%;\\r\\n    cursor: pointer;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-widget__logo-link:hover:after {\\r\\n    content: \\\"\\\";\\r\\n    position: absolute;\\r\\n    width: 100%;\\r\\n    left: 0;\\r\\n    top: 100%;\\r\\n    height: 1px;\\r\\n    background: #a3a3ad;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list {\\r\\n\\tflex-direction: row;\\r\\n    display: flex;\\r\\n    margin: 0 -15px;\\r\\n    letter-spacing: -0.31em;\\r\\n    flex-wrap: wrap;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list:before, .grf-list:after {\\r\\n    display: table;\\r\\n    content: \\\" \\\";\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list:after {\\r\\n    clear: both;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__item {\\r\\n    padding: 0;\\r\\n    display: inline-block;\\r\\n    vertical-align: top;\\r\\n    letter-spacing: normal;\\r\\n    width: 100%;\\r\\n    -webkit-box-sizing: border-box;\\r\\n    -moz-box-sizing: border-box;\\r\\n    box-sizing: border-box;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__link {\\r\\n\\tpadding: 15px;\\r\\n    display: block;\\r\\n    position: relative;\\r\\n    text-decoration: none;\\r\\n\\theight: 100%;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__link:hover{\\r\\n\\tbackground-color: #f0f1f2;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__link-img {\\r\\n    position: relative;\\r\\n    min-width: 100%;\\r\\n    padding-top: 66.91%;\\r\\n    margin-bottom: 20px;\\r\\n    overflow: hidden;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__link-title {\\r\\n    display: block;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__img {\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n    max-width: 100%;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__title {\\r\\n    display: block;\\r\\n    line-height: 21px;\\r\\n    color: #1A1A1A;\\r\\n    cursor: pointer;\\r\\n    font-family: inherit;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__item .grf-list__ads{\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list--rv .grf-list__item[data-type=\\\"rv\\\"] .grf-list__ads{\\r\\n    display: none;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__item[data-type=\\\"rv\\\"] .grf-list__ads {\\r\\n\\tmargin-top: 15px;\\r\\n    display: block;\\r\\n    line-height: normal;\\r\\n    color: #b2b2b2;\\r\\n    font-family: Verdana, sans-serif;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list__announce {\\r\\n    margin-top: 15px;\\r\\n    display: block;\\r\\n\\tfont-size: 13px;\\r\\n    line-height: 16px;\\r\\n\\tcolor: #1A1A1A;\\r\\n    font-family: inherit;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list[data-cols=\\\"6\\\"] .grf-list__item {\\r\\n    width: 16.666666%;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list[data-cols=\\\"5\\\"] .grf-list__item {\\r\\n    width: 20%;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list[data-cols=\\\"4\\\"] .grf-list__item {\\r\\n    width: 25%;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list[data-cols=\\\"3\\\"] .grf-list__item {\\r\\n    width: 33.333333%;\\r\\n}\\r\\n\\r\\n.grf-widget--%ADP_ID% .grf-list[data-cols=\\\"2\\\"] .grf-list__item {\\r\\n    width: 50%;\\r\\n}</style>\", \"preload_js\": \"\", \"header\": \"<div class=\\\"grf-widget grf-widget--%ADP_ID%\\\" data-cols=\\\"%COLS%\\\">\\r\\n\\t<div class=\\\"grf-widget__heading\\\">\\u041f\\u0435\\u0440\\u0441\\u043e\\u043d\\u0430\\u043b\\u044c\\u043d\\u0430\\u044f \\u043f\\u043e\\u0434\\u0431\\u043e\\u0440\\u043a\\u0430 \\u043d\\u043e\\u0432\\u043e\\u0441\\u0442\\u0435\\u0439:</div>\\r\\n    <div class=\\\"grf-widget__content\\\">\\r\\n        <div class=\\\"grf-list\\\" data-cols=\\\"%COLS%\\\" data-rows=\\\"%ROWS%\\\">\"}, \"int\": {\"fill\": 70, \"id\": 1940896}, \"na\": {\"fill\": 0, \"id\": 1940898}, \"rv\": {\"fill\": 30, \"id\": 1940900}, \"idx\": 0, \"aud\": {\"fill\": 0, \"id\": 1940898}}], \"name\": \"inforeactorru\", \"url_settings\": {\"store_hash\": false, \"safe_params\": []}} : undefined);\n\n//# sourceURL=webpack:///./index.js?");

/***/ }),

/***/ "./partials/Cookies.js":
/*!*****************************!*\
  !*** ./partials/Cookies.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = GRF_Cookies;\nfunction GRF_Cookies() {}\n\nGRF_Cookies.prototype = {\n    get: function get(name) {\n        var matches = document.cookie.match(new RegExp(\"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"));\n        return matches ? decodeURIComponent(matches[1]) : undefined;\n    },\n    set: function set(name, value, options) {\n        options = options || {};\n\n        var expires = options.expires;\n\n        if (typeof expires == \"number\" && expires) {\n            var d = new Date();\n            d.setTime(d.getTime() + expires * 1000);\n            expires = options.expires = d;\n        }\n        if (expires && expires.toUTCString) {\n            options.expires = expires.toUTCString();\n        }\n\n        value = encodeURIComponent(value);\n\n        var updatedCookie = name + \"=\" + value;\n\n        for (var propName in options) {\n            updatedCookie += \"; \" + propName;\n            var propValue = options[propName];\n            if (propValue !== true) {\n                updatedCookie += \"=\" + propValue;\n            }\n        }\n\n        document.cookie = updatedCookie;\n    }\n};\n\n//# sourceURL=webpack:///./partials/Cookies.js?");

/***/ }),

/***/ "./partials/Giraff.js":
/*!****************************!*\
  !*** ./partials/Giraff.js ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.default = GRF;\n\nvar _Cookies = __webpack_require__(/*! ./Cookies.js */ \"./partials/Cookies.js\");\n\nvar _Cookies2 = _interopRequireDefault(_Cookies);\n\nvar _Stats = __webpack_require__(/*! ./Stats.js */ \"./partials/Stats.js\");\n\nvar _Stats2 = _interopRequireDefault(_Stats);\n\nvar _jsonp = __webpack_require__(/*! ./jsonp.js */ \"./partials/jsonp.js\");\n\nvar _jsonp2 = _interopRequireDefault(_jsonp);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction GRF(version, config) {\n    // Подписываемся на сообщения\n    var that = this;\n    if (window.addEventListener) {\n        window.addEventListener(\"message\", function (event) {\n            that.message_handler(event);\n        }, false);\n    } else {\n        window.attachEvent(\"onmessage\", function (event) {\n            that.message_handler(event);\n        });\n    }\n\n    this.config = config;\n    this.name = this.config.name;\n    this.widgets = this.config.widgets;\n    this.url_settings = this.config.url_settings;\n\n    var iframe_settings = false;\n    try {\n        iframe_settings = window.name ? JSON.parse(window.name) : false;\n    } catch (e) {}\n\n    this.is_amp = (typeof iframe_settings === 'undefined' ? 'undefined' : _typeof(iframe_settings)) == \"object\" && iframe_settings.attributes && iframe_settings.attributes.hasOwnProperty('ampSlotIndex');\n\n    this.parent = this.is_amp ? window : window.top;\n    this.is_parent = this.parent == window;\n    this.run_mode = 'default';\n    if (typeof this.config.run_mode == 'string' && this.config.run_mode == 'callback') {\n        this.run_mode = 'callback';\n    }\n    if (typeof this.config.single_mode != 'undefined') {\n        this.single_mode = this.config.single_mode;\n    }\n    this.callback_name = null;\n    this.callback_options = null;\n\n    this.amp_context = this.is_amp ? iframe_settings.attributes._context : null;\n\n    // Проверяем наличие adBlock у пользователя\n    // this.adblockDetected = false;\n\n    this.check_adBlock(function () {\n        if (that.is_parent) {\n            // Если окно главное - инициализируемся\n\n            that.cookies = new _Cookies2.default();\n\n            that.inactive = false; //Math.random() < 0.03;\n            that.mode = that.get_mode(0);\n\n            var url = that.get_canonical_url();\n            var is_canonical = url ? true : false;\n            if (!url) {\n                url = window.location.href;\n            }\n            that.set_url(url, is_canonical);\n\n            var is_vac = window.location.href.indexOf('utm_source=grf-eng') > -1;\n            if (is_vac) {\n                that.cookies.set('_grf_vac', 1, { path: '/' });\n            } else if (that.cookies.get('_grf_vac')) {\n                is_vac = true;\n            }\n\n            var vis = false;\n            that.ref = \"\";\n            var doc_referrer = that.is_amp ? that.amp_context.referrer : document.referrer;\n            var ref_domain = doc_referrer.split('/')[2];\n            var cur_domain = window.location.href.split('/')[2];\n            var coo_domain = that.cookies.get('_grf_ref');\n            var is_vis = that.cookies.get('_grf_vis');\n\n            if (!ref_domain) {\n                ref_domain = cur_domain;\n            }\n            if (ref_domain == cur_domain && !is_vis) {\n                vis = true;\n                that.cookies.set('_grf_vis', 1, { path: '/' });\n            }\n\n            if (ref_domain != cur_domain) {\n                vis = true;\n                that.ref = ref_domain;\n                that.cookies.set('_grf_vis', 1, { path: '/' });\n                that.cookies.set('_grf_ref', ref_domain, { path: '/', expires: 2592000 });\n            } else if (coo_domain && coo_domain != cur_domain) {\n                that.ref = coo_domain;\n            }\n\n            // Запускаем статистику\n            that.stats = new _Stats2.default({\n                name: that.name,\n                url: that.url,\n                url_settings: that.url_settings,\n                is_vac: is_vac,\n                vis: vis,\n                referrer: that.ref,\n                adblockDetected: that.adblockDetected,\n                referrer_full: doc_referrer,\n                version: version\n            }, that);\n            that.stats.run();\n        }\n\n        if ('default' == that.run_mode) {\n            that.parent.postMessage(\"giraff:get_config:\" + that.config.name, \"*\");\n        }\n    });\n};\nGRF.prototype = {\n    widget_queue: [],\n    draw_queue: [],\n    pv_tags: [],\n    has_active_drawing: false,\n    is_drawing: false,\n    single_mode: true,\n    window_count: 0,\n    window_idx: 0,\n    widget_drawn: 0,\n    check_adBlock: function check_adBlock(cb) {\n        var timer,\n            that = this,\n            pixel = new Image();\n\n        function clearTimer() {\n            if (timer) {\n                clearTimeout(timer);\n                timer = null;\n            }\n        }\n        function handleFail() {\n            pixel.onload = pixel.onabort = pixel.onerror = function () {};\n            that.adblockDetected = false;\n            clearTimer();\n            if (cb) cb();\n        }\n\n        pixel.onload = function () {\n            clearTimer();\n            that.adblockDetected = false;\n            if (cb) cb();\n        };\n        pixel.onerror = function () {\n            clearTimer();\n            that.adblockDetected = true;\n            if (cb) cb();\n        };\n\n        pixel.src = 'https://mc.yandex.ru/metrika/advert.gif';\n\n        timer = setTimeout(function () {\n            handleFail();\n        }, 1000);\n    },\n    change_article: function change_article(url, elem, is_canonical) {\n        is_canonical = is_canonical ? true : false;\n        if (url) {\n            this.set_url(url, is_canonical);\n        }\n        if (elem) {\n            this.set_container(elem);\n        }\n    },\n    message_handler: function message_handler(event) {\n        if (\"string\" != typeof event.data) {\n            return;\n        }\n        var data = event.data.split(':');\n        if (data[0] != \"giraff\" || data[data.length - 1] != this.config.name) {\n            return;\n        }\n        if (data[1] == \"get_config\") {\n            this.window_count++;\n            var mode = this.inactive ? 'inactive' : this.single_mode ? this.mode : 'multi';\n            event.source.postMessage(\"giraff:set_config:\" + this.window_count + \":\" + mode + \":\" + encodeURIComponent(this.url) + \":\" + encodeURIComponent(this.ref) + \":\" + this.config.name, \"*\");\n            return;\n        }\n        if (data[1] == \"set_config\") {\n            this.window_idx = data[2];\n            if (data[3] == \"inactive\") {\n                this.mode = false;\n                this.inactive = true;\n            } else if (data[3] == \"multi\") {\n                this.mode = false;\n                this.inactive = false;\n            } else {\n                this.mode = data[3];\n                this.inactive = false;\n            }\n            this.set_url(decodeURIComponent(data[4]), true);\n            this.ref = decodeURIComponent(data[5]);\n            this.run();\n            return;\n        }\n        if (data[1] == \"draw_request\") {\n            this.draw_queue.push(event.source);\n            this.allow_drawing();\n            return;\n        }\n        if (data[1] == \"draw_done\") {\n            this.has_active_drawing = false;\n            this.allow_drawing();\n            if (window.giraff[this.config.name] && window.giraff[this.config.name].callbacks && window.giraff[this.config.name].callbacks.widget) {\n                window.giraff[this.config.name].callbacks.widget();\n            }\n            return;\n        }\n        if (data[1] == \"draw_allowed\") {\n            this._draw();\n            return;\n        }\n        if (data[1] == \"pv_tags\") {\n            if (data[2]) {\n                var pv_tags = data[2].split(',');\n                this.stats.send_pv_tags(pv_tags);\n            }\n            return;\n        }\n    },\n    get_canonical_url: function get_canonical_url() {\n        var ms = document.getElementsByTagName('meta');\n        for (var i = 0; i < ms.length; i++) {\n            var p, u;\n            if ((p = ms[i].getAttribute('property')) && p == 'og:url' && (u = ms[i].getAttribute('content')) && u.substr(0, 4) == 'http') {\n                return u;\n            }\n        }\n        return false;\n    },\n    set_url: function set_url(url, is_canonical) {\n        if (!is_canonical) {\n            var hash = '';\n            if (url.indexOf('#')) {\n                var t = url.split('#');\n                url = t.shift();\n                if (this.url_settings.store_hash) {\n                    hash = t.join('#');\n                }\n            }\n            var params = '';\n            if (url.indexOf('?')) {\n                var t = url.split('?');\n                url = t.shift();\n                params = t.join('?');\n            }\n            var good_params = [];\n            if (params.length) {\n                var p = params.split('&');\n                for (var i = 0; i < p.length; i++) {\n                    var pname = p[i].split('=')[0];\n                    if (this.url_settings.safe_params.indexOf(pname) > -1) {\n                        good_params.push(p[i]);\n                    }\n                }\n            }\n            this.url = url + (good_params.length ? '?' + good_params.join('&') : '') + (hash ? '#' + hash : '');\n        } else {\n            this.url = url;\n        }\n        if (this.stats) {\n            this.stats.set_url(this.url);\n        }\n    },\n    set_container: function set_container(elem) {\n        this.stats.set_container(elem);\n    },\n    get_mode: function get_mode(idx) {\n        if (idx >= this.widgets.length) {\n            return false;\n        }\n        if (this.mode) {\n            return this.mode;\n        }\n        var w = this.widgets[idx];\n        var t = [{ mode: 'ae', fill: w['ae']['fill'] }, { mode: 'na', fill: w['na']['fill'] }, { mode: 'rv', fill: w['rv']['fill'] }];\n        var mode,\n            sum = 0,\n            r = Math.random() * 100;\n        for (var i in t) {\n            sum += t[i]['fill'];\n            if (r <= sum) {\n                mode = t[i]['mode'];\n                break;\n            }\n        }\n        return mode;\n    },\n    run: function run() {\n        // Запускаем Mutation observer, он будет класть элементы в очередь и запускать обработку очереди\n        var that = this;\n        this.observer = new MutationObserver(function (mutations) {\n            var new_widgets = 0;\n            mutations.forEach(function (mutation) {\n                if (mutation.type != 'childList' || !mutation.addedNodes.length) {\n                    return;\n                }\n\n                Array.prototype.forEach.call(mutation.addedNodes, function (child) {\n\n                    Array.prototype.forEach.call(that.widgets, function (elem) {\n                        if (elem.selector) {\n                            // если выбрана вставка по селектору\n                            if (child.tagName && child.matches(elem.selector)) {\n                                var div = document.createElement('div');\n                                div.id = \"grf_\" + that.name + \"_\" + (elem.idx + 1);\n                                if (document.querySelector(elem.selector)) {\n                                    var sibling = child.nextSibling;\n                                    if (!sibling || sibling.tagName != \"DIV\" || !sibling.matches('div[id^=\"grf_' + that.name + '\"]')) {\n                                        child.insertAdjacentElement('afterEnd', div);\n                                        that.widget_queue.push(div);\n                                        new_widgets++;\n                                    }\n                                }\n                            } else if (child.childNodes.length) {\n                                Array.prototype.forEach.call(child.querySelectorAll(elem.selector), function (schild) {\n                                    var div = document.createElement('div');\n                                    div.id = \"grf_\" + that.name + \"_\" + (elem.idx + 1);\n                                    if (document.querySelector(elem.selector)) {\n                                        var sibling = schild.nextSibling;\n                                        if (!sibling || sibling.tagName != \"DIV\" || !sibling.matches('div[id^=\"grf_' + that.name + '\"]')) {\n                                            schild.insertAdjacentElement('afterEnd', div);\n                                            that.widget_queue.push(div);\n                                            new_widgets++;\n                                        }\n                                    }\n                                });\n                            }\n                        }\n\n                        if (child.nodeName == 'DIV' && child.id && 0 == child.id.indexOf('grf_' + that.name)) {\n                            that.widget_queue.push(child);\n                            new_widgets++;\n                        } else if (child.childNodes.length) {\n                            Array.prototype.forEach.call(child.querySelectorAll('div[id^=\"grf_' + that.name + '\"]'), function (schild) {\n                                that.widget_queue.push(schild);\n                                new_widgets++;\n                            });\n                        }\n                    });\n                });\n            });\n\n            if (new_widgets > 0) {\n                that.draw();\n            }\n        });\n\n        this.observer.observe(document, { childList: true, subtree: true });\n\n        Array.prototype.forEach.call(this.widgets, function (elem) {\n            if (elem.selector) {\n                var elementsBeforeWidget = document.querySelectorAll(elem.selector);\n\n                if (elementsBeforeWidget.length > 0) {\n                    Array.prototype.forEach.call(elementsBeforeWidget, function (child) {\n                        var div = document.createElement('div');\n                        div.id = \"grf_\" + that.name + \"_\" + (elem.idx + 1);\n                        var sibling = child.nextSibling;\n                        if (!sibling || sibling.tagName != \"DIV\" || !sibling.matches('div[id^=\"grf_' + that.name + '\"]')) {\n                            child.insertAdjacentElement('afterEnd', div);\n                        }\n                    });\n                }\n            }\n        });\n\n        // Получаем список всех наших DIV и так же кладём в очередь\n        var widgets = document.querySelectorAll('div[id^=\"grf_' + this.name + '\"]');\n        if (widgets.length) {\n            Array.prototype.forEach.call(widgets, function (child) {\n                that.widget_queue.push(child);\n            });\n            this.draw();\n        }\n    },\n    allow_drawing: function allow_drawing() {\n        if (this.inactive || !this.draw_queue.length || this.has_active_drawing) {\n            return;\n        }\n\n        this.has_active_drawing = true;\n        var next_drawer = this.draw_queue.shift();\n        next_drawer.postMessage(\"giraff:draw_allowed:\" + this.config.name, \"*\");\n    },\n    draw: function draw() {\n        if (!this.widget_queue.length || this.is_drawing) {\n            return;\n        }\n        this.is_drawing = true;\n\n        this.parent.postMessage(\"giraff:draw_request:\" + this.config.name, \"*\");\n    },\n    _draw: function _draw() {\n        if (!this.widget_queue.length) {\n            this.onDrawDone();\n            return;\n        }\n\n        var w_el = this.widget_queue.shift();\n        if (w_el.id.indexOf(\"grf_\" + this.name) != 0) {\n            this._draw();\n            return;\n        }\n\n        var wid = w_el.id.replace(\"grf_\" + this.name, \"\").split('_');\n\n        var widget_idx;\n        if (wid.length == 1) {\n            widget_idx = 1;\n            w_el.id += \"_1\";\n        } else if (wid.length == 2) {\n            widget_idx = wid[1];\n        } else {\n            this._draw();\n            return;\n        }\n        widget_idx--;\n        if (\"object\" != _typeof(this.widgets[widget_idx])) {\n            this._draw();\n            return;\n        }\n\n        this.widget_drawn++;\n        w_el.id += \"_\" + this.window_idx + \"_\" + this.widget_drawn;\n\n        var that = this;\n        var wmode = this.get_mode(widget_idx);\n\n        if (\"cells\" in this.widgets[widget_idx]) {\n            if (this.adblockDetected) {\n                var cells = this.widgets[widget_idx][\"cells\"];\n                for (var i = 0; i < cells.length; i++) {\n                    if (cells[i] != 'ae') cells[i] = 'ae';\n                }\n            }\n            this.load_widget_data(w_el.id, widget_idx);\n        } else {\n            if (this.adblockDetected) {\n                wmode = \"ae\";\n            }\n            this.draw_widget(w_el.id, this.widgets[widget_idx][wmode]['id'], wmode, widget_idx, function () {\n                that._draw();\n            });\n        }\n        this.widgets[widget_idx][\"on_show_tags\"] = [];\n        if (this.widgets[widget_idx]['combo_mode']) {\n            var cm = this.widgets[widget_idx]['combo_mode'];\n            for (var j in cm) {\n                this.pv_tags.push(cm[j]);\n                this.widgets[widget_idx][\"on_show_tags\"].push(cm[j]);\n            }\n        } else if (this.widgets[widget_idx]['cells']) {\n            for (var i = 0; i < this.widgets[widget_idx][\"cells\"].length; i++) {\n                var type = this.widgets[widget_idx][\"cells\"][i];\n                this.pv_tags.push('pv_' + (type == 'mt' || type == 'cr' ? 'rv' : type));\n                this.widgets[widget_idx][\"on_show_tags\"].push('pv_' + (type == 'mt' || type == 'cr' ? 'rv' : type));\n            }\n        } else {\n            this.pv_tags.push('pv_' + wmode);\n            this.widgets[widget_idx][\"on_show_tags\"].push('pv_' + wmode);\n        }\n    },\n    load_widget_data: function load_widget_data(div_id, widget_idx) {\n        /*\n        1) Грузим нужно количество тизеров каждого типа\n        2) Подставляем их в шаблон\n        3) Заполняем DIV\n        */\n        var w = this.widgets[widget_idx];\n        var promoArr = w[\"promo_ads\"] ? w[\"promo_ads\"].slice() : [];\n\n        var nba = {};\n\n        for (var i = 0; i < w[\"cells\"].length; i++) {\n\n            var wid, wtype;\n            if (w[\"cells\"][i] == 'cr' && !w['cr_id']) {\n                w[\"cells\"][i] = 'rv';\n            }\n\n            switch (w[\"cells\"][i]) {\n                case 'ae':\n                case 'rv':\n                case 'na':\n                    wid = w[w[\"cells\"][i]][\"id\"];\n                    break;\n                case 'ps':\n                    var mode = this.get_mode(widget_idx);\n                    wid = w[mode][\"id\"];\n                    w[\"cells\"][i] = mode;\n                    break;\n                case 'pr':\n                    if (promoArr.length) {\n                        var sa = promoArr[Math.floor(Math.random() * promoArr.length)];\n                        var index = promoArr.indexOf(sa);\n                        promoArr.splice(index, 1);\n                        wid = 'pr' + sa;\n                    } else {\n                        wid = w[\"ae\"][\"id\"];\n                        w[\"cells\"][i] = \"ae\";\n                    }\n                    break;\n                case 'mt':\n                    wid = 'mt' + w['mt_id'];\n                    break;\n                case 'cr':\n                    wid = w['cr_id'];\n                    break;\n            }\n            wtype = w[\"cells\"][i];\n            wid in nba ? nba[wid][\"count\"]++ : nba[wid] = { \"count\": 1, \"type\": wtype };\n        }\n\n        var to_load = [];\n        for (var adp_id in nba) {\n            to_load.push({ \"id\": adp_id, \"num\": nba[adp_id][\"count\"], \"type\": nba[adp_id][\"type\"] });\n        }\n\n        this.load_teasers(div_id, to_load, 0, [], widget_idx);\n    },\n    load_teasers: function load_teasers(div_id, to_load, idx, result, widget_idx, diff) {\n        if (idx >= to_load.length && !diff) {\n            return this.draw_widget_cells(div_id, result, widget_idx);\n        }\n\n        var src;\n        var type = diff ? \"rv\" : to_load[idx][\"type\"];\n        var that = this;\n        switch (type) {\n            case 'ae':\n            case 'rv':\n            case 'na':\n                var domain = this.widgets[widget_idx][\"ads_domain\"] || 'a.giraff.io';\n                var num = diff ? diff : to_load[idx][\"num\"];\n                var id = diff ? this.widgets[widget_idx]['rev']['id'] : to_load[idx][\"id\"];\n                src = '//' + domain + '/data/' + id + '.js?json=1&async=1&cs=utf-8&rand=' + Math.random();\n                if (num > 0) {\n                    src += '&num=' + num;\n                }\n                if (diff) {\n                    src += '&tag=grf_rvf_' + id;\n                } else if ('rv' == type && 2006962 == id) {\n                    src += '&tag=grf_rv_' + id;\n                }\n                break;\n            case 'pr':\n                var domain = this.widgets[widget_idx][\"ads_domain\"] || 'a.giraff.io';\n                var num = diff ? diff : to_load[idx][\"num\"];\n                var id = this.widgets[widget_idx]['ae']['id'];\n                src = '//' + domain + '/data/' + id + '.js?json=1&async=1&cs=utf-8&rand=' + Math.random();\n                if (to_load[idx][\"id\"].substr(0, 2) == \"pr\") {\n                    var sa = to_load[idx][\"id\"].substr(2, to_load[idx][\"id\"].length - 2);\n                    src += '&sa=' + sa;\n                }\n                break;\n            case 'mt':\n                var num = to_load[idx][\"num\"];\n                src = '//ad.mail.ru/adq/?q=204300&sitename=rv' + this.widgets[widget_idx]['rv']['id'];\n                if (num > 0) {\n                    src += '&count=' + num;\n                }\n                break;\n            case 'cr':\n                var num = to_load[idx][\"num\"];\n                var zoneid = to_load[idx][\"id\"];\n                var adUnit = {\n                    \"placements\": [{\n                        \"slotid\": div_id,\n                        \"zoneid\": zoneid,\n                        \"nativeCallback\": function nativeCallback(assets) {\n                            result[zoneid] = result[zoneid] ? result[zoneid] : [];\n                            for (var i = 0; i < assets.products.length; i++) {\n                                result[zoneid].push({\n                                    'rtype': \"cr\",\n                                    'url': assets.products[i].click_url,\n                                    'announce': assets.products[i].description,\n                                    'title': assets.products[i].title,\n                                    'img': assets.products[i].image.url,\n                                    'privacy': {\n                                        'optout_click_url': assets.privacy.optout_click_url,\n                                        'optout_image_url': assets.privacy.optout_image_url\n                                    },\n                                    'pixels': assets.impression_pixels\n                                });\n                            }\n                            if (num > assets.products.length) {\n                                var count = num - assets.products.length;\n                                that.load_teasers(div_id, to_load, idx, result, widget_idx, count);\n                            } else {\n                                that.load_teasers(div_id, to_load, ++idx, result, widget_idx);\n                            }\n                        }\n                    }]\n                };\n                var parseCriteoBids = function parseCriteoBids() {\n                    Criteo.events.push(function () {\n                        var ctoBid = Criteo.GetBidsForAdUnit(div_id)[0];\n                        if (ctoBid) {\n                            Criteo.RenderAd({ bidId: ctoBid.id, containerId: ctoBid.impressionId });\n                        } else {\n                            // Passback\n                            // Запрашиваем rv тизеры вместо критео, если оттуда ничего не пришло или ошибка\n                            that.load_teasers(div_id, to_load, idx, result, widget_idx, to_load[idx][\"num\"]);\n                        }\n                    });\n                };\n                var initCriteo = function initCriteo() {\n                    Criteo.events.push(function () {\n                        Criteo.RequestBids(adUnit, parseCriteoBids, 1500);\n                    });\n                };\n                if (!window.Criteo || !window.Criteo.events) {\n                    var script = document.createElement('script');\n                    script.src = \"https://static.criteo.net/js/ld/publishertag.js\";\n                    script.onload = function () {\n                        initCriteo();\n                    };\n                    document.getElementsByTagName('head')[0].appendChild(script);\n                } else {\n                    initCriteo();\n                }\n                break;\n        }\n\n        if (type != 'cr') {\n            (0, _jsonp2.default)(src, {\n                onSuccess: function onSuccess(data) {\n                    if (data) {\n                        var count;\n                        if (to_load[idx][\"type\"] == 'mt') {\n                            if (data.feed) {\n                                for (var i = 0; i < data.feed.banners.length; i++) {\n                                    Object.assign(data.feed.banners[i], { \"rtype\": type });\n                                }\n                                result[to_load[idx][\"id\"]] = data.feed.banners;\n                            } else {\n                                for (var i = 0; i < data.length; i++) {\n                                    Object.assign(data[i], { \"rtype\": type });\n                                }\n                                result[to_load[idx][\"id\"]] = Array.isArray(result[to_load[idx][\"id\"]]) ? result[to_load[idx][\"id\"]].concat(data) : [];\n                            }\n                        } else {\n                            for (var i = 0; i < data.length; i++) {\n                                Object.assign(data[i], { \"rtype\": type });\n                            }\n                            result[to_load[idx][\"id\"]] = data;\n                        }\n                        var resultItems = result[to_load[idx][\"id\"]].length;\n                        if ([\"mt\"].indexOf(to_load[idx][\"type\"]) != -1 && resultItems < to_load[idx][\"num\"]) {\n                            count = to_load[idx][\"num\"] - resultItems;\n                            idx--;\n                        }\n                        that.load_teasers(div_id, to_load, ++idx, result, widget_idx, count);\n                    } else {\n                        that.load_teasers(div_id, to_load, idx, result, widget_idx, to_load[idx][\"num\"]);\n                    }\n                },\n                onError: function onError() {\n                    if ([\"mt\"].indexOf(to_load[idx][\"type\"]) != -1) {\n                        that.load_teasers(div_id, to_load, idx, result, widget_idx, to_load[idx][\"num\"]);\n                    }\n                }\n            });\n        }\n    },\n    draw_widget_cells: function draw_widget_cells(div_id, result, widget_idx) {\n        var w = this.widgets[widget_idx];\n        var template = this.widgets[widget_idx]['tpl'];\n        var tags = {};\n\n        tags = {\n            \"adp_id\": w[\"ae\"][\"id\"],\n            \"cols\": w[\"cols\"],\n            \"rows\": Math.ceil(w[\"cells\"].length / w[\"cols\"])\n        };\n\n        var out = '';\n        out += this._replace_tags(template['css'], tags);\n        out += this._replace_tags(template['header'], tags);\n        out += this._replace_tags(template['row_header'], tags);\n        out += this._build_items(widget_idx, result, template['item'], tags);\n        out += this._replace_tags(template['row_footer'], tags);\n        out += this._replace_tags(template['footer'], tags);\n        document.getElementById(div_id).innerHTML = out;\n\n        var rvArray = [];\n        w[\"on_show_tags\"].map(function (item) {\n            if (item == 'pv_rv') {\n                rvArray.push(item);\n            }\n        });\n\n        if (rvArray.length == w[\"on_show_tags\"].length) {\n            document.getElementById(div_id).querySelector('.grf-list').classList.add(\"grf-list--rv\");\n        }\n\n        if (template['preload_js']) {\n            try {\n                var __da_widget_id = this.widgets[widget_idx][\"ae\"][\"id\"];\n                var __da_widget_div = div_id;\n                var __da_widget_src = null;\n                var __da_widget_charset = \"utf-8\";\n                eval(template['preload_js']);\n            } catch (e) {\n                console.log(e);\n            }\n        }\n\n        this._draw();\n    },\n    _build_items: function _build_items(widget_idx, result, template, tags) {\n        var out = '';\n        var w = this.widgets[widget_idx];\n        var promos = [];\n\n        for (var i = 0; i < w[\"cells\"].length; i++) {\n            var type = w[\"cells\"][i];\n            var adp_id;\n            switch (type) {\n                case \"mt\":\n                    adp_id = 'mt' + w[\"mt_id\"];\n                    break;\n                case \"pr\":\n                    for (var block in result) {\n                        if (block.substr(0, 2) == \"pr\" && promos.indexOf(block) < 0) {\n                            adp_id = block;\n                            promos.push(adp_id);\n                            break;\n                        }\n                    }\n                    break;\n                case \"cr\":\n                    adp_id = w['cr_id'];\n                    break;\n                case \"na\":\n                case \"ae\":\n                case \"rv\":\n                    adp_id = w[type][\"id\"];\n                    break;\n            }\n\n            if (result[adp_id] && result[adp_id].length) {\n                var item = result[adp_id].shift();\n                item[\"cell_type\"] = type;\n                item[\"rtype\"] = \"rtype\" in item ? item[\"rtype\"] : type;\n                item[\"announce\"] = \"description\" in item ? item[\"description\"] : item[\"announce\"];\n                item[\"img\"] = \"image_492x277\" in item ? item[\"image_492x277\"] : item[\"img\"];\n                out += this._replace_item_tags(template, item, tags);\n            }\n        }\n\n        return out;\n    },\n    _replace_tags: function _replace_tags(template, tags) {\n        var tpl = template;\n        if (!tpl) {\n            return \"\";\n        }\n        tpl = tpl.replace(/%ADP_ID%/g, \"adp_id\" in tags ? tags[\"adp_id\"] : \"\");\n        tpl = tpl.replace(/%COLS%/g, \"cols\" in tags ? tags[\"cols\"] : \"\");\n        tpl = tpl.replace(/%ROWS%/g, \"rows\" in tags ? tags[\"rows\"] : \"\");\n        return tpl;\n    },\n    _replace_item_tags: function _replace_item_tags(template, item, tags) {\n        var tpl = template;\n        if (!tpl) {\n            return \"\";\n        }\n\n        if (item[\"cell_type\"] == \"mt\" && item['banner_id']) {\n            var mt_pixel = new Image();\n            mt_pixel.onload = function () {\n                // console.log('MT Pixel Init');\n            };\n            mt_pixel.src = item['statistics'][0]['url'];\n        }\n\n        if (item[\"rtype\"] == \"cr\") {\n            var wrap = document.createElement('div');\n            wrap.innerHTML = tpl;\n            var privacyLink = document.createElement('a');\n            privacyLink.classList = \"grf-list__item-privacy-link\";\n            privacyLink.href = item.privacy.optout_click_url;\n            privacyLink.target = \"_blank\";\n            privacyLink.innerHTML = '<img src=\"' + item.privacy.optout_image_url + '\">';\n            wrap.querySelector(\"a\").parentNode.insertBefore(privacyLink, wrap.querySelector(\"a\"));\n            for (var i = 0; i < item.pixels.length; i++) {\n                var pixel = document.createElement('img');\n                pixel.src = item.pixels[i].url;\n                pixel.style.display = 'none';\n                pixel.setAttribute(\"width\", \"0px\");\n                pixel.setAttribute(\"height\", \"0px\");\n                wrap.querySelector(\"a\").parentNode.insertBefore(pixel, null);\n            }\n\n            tpl = wrap.innerHTML;\n        }\n\n        if (item[\"cell_type\"] == \"mt\" || item[\"cell_type\"] == \"cr\") {\n            item[\"cell_type\"] = \"rv\";\n        } else if (item[\"cell_type\"] == \"pr\") {\n            item[\"cell_type\"] = \"ae\";\n        }\n\n        tpl = this._replace_tags(tpl, tags);\n        tpl = tpl.replace(/%TITLE%/g, \"title\" in item ? item[\"title\"] : \"\");\n        if (item[\"cell_type\"] == \"rv\") {\n            var url = \"url\" in item ? item[\"url\"] : \"\";\n            var hit = 'click/rv/' + this.name;\n            var r = this.ref ? '&ref=' + encodeURIComponent(this.ref) : '';\n            var clickwrap = \"https://data.giraff.io/\" + hit + \"/?u=\" + encodeURIComponent(this.url) + r + \"&go=\" + encodeURIComponent(url);\n            tpl = tpl.replace(/%URL%/g, url ? clickwrap : \"\");\n        } else {\n            tpl = tpl.replace(/%URL%/g, \"url\" in item ? item[\"url\"] : \"\");\n        }\n        tpl = tpl.replace(/%CELL_RTYPE%/g, \"rtype\" in item ? item[\"rtype\"] : \"\");\n        tpl = tpl.replace(/%ANNOUNCE%/g, \"announce\" in item ? item[\"announce\"] : \"\");\n        tpl = tpl.replace(/%CELL_TYPE%/g, \"cell_type\" in item ? item[\"cell_type\"] : \"\");\n        tpl = tpl.replace(/%TARGET%/g, \"cell_type\" in item && \"ae\" == item[\"cell_type\"] ? \"_top\" : \"_blank\");\n        tpl = tpl.replace(/%IMG_(\\d+)x(\\d+)%/g, function (str, w, h) {\n            return \"img\" in item ? item[\"img\"].replace('100x100', w + 'x' + h) : \"\";\n        });\n        return tpl;\n    },\n    draw_widget: function draw_widget(div_id, adp_id, mode, widget_idx, callback) {\n        var hit = 'click/' + mode + '/' + this.name;\n        var s = document.createElement('script');\n        s.type = 'text/javascript';\n        var r = this.ref ? '&ref=' + encodeURIComponent(this.ref) : '';\n        var clickwrap = encodeURIComponent(\"https://data.giraff.io/\" + hit + \"/?u=\" + encodeURIComponent(this.url) + r + \"&go=\");\n        var domain = this.widgets[widget_idx][\"ads_domain\"] || 'a.giraff.io';\n        if ('whotrades' == this.name || 'whotradesen' == this.name) {\n            domain = 'grf.whotrades.com';\n        }\n        if ('lifestylebuzz' == this.name) {\n            domain = 'a.lifestylebuzz.ru';\n        }\n        var src = '//' + domain + '/data/' + adp_id + '.js?div=' + div_id + '&async=1&cs=utf-8&rand=' + Math.random() + '&clickwrap=' + clickwrap;\n        if (this.run_mode == 'callback') {\n            src += '&json=1&callback=' + this.callback_name;\n            if (this.callback_options && this.callback_options.limit && this.callback_options.limit > 0) {\n                src += '&num=' + this.callback_options.limit;\n            }\n        }\n        s.src = src;\n        s.async = true;\n        if ('undefined' != typeof s.onload) {\n            s.onerror = function () {\n                callback();\n            };\n            s.onload = function () {\n                setTimeout(callback, 1);\n            };\n        }\n\n        var doc = document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0];\n        doc.appendChild(s);\n\n        if ('undefined' == typeof s.onload) {\n            var o = setInterval(function () {\n                if (document.getElementById(div_id).innerHTML) {\n                    callback();\n                    clearInterval(o);\n                }\n            }, 50);\n        }\n        return true;\n    },\n    onDrawDone: function onDrawDone() {\n        this.is_drawing = false;\n        this.parent.postMessage(\"giraff:draw_done:\" + this.config.name, \"*\");\n        this.sendCustomTags(this.pv_tags);\n        var tags = this.stats.check_visible_widget();\n        if (tags.length) {\n            this.sendCustomTags(tags);\n        }\n    },\n    sendCustomTags: function sendCustomTags(tags) {\n        if (tags.length) {\n            this.parent.postMessage(\"giraff:pv_tags:\" + tags.join(',') + \":\" + this.config.name, \"*\");\n        }\n    }\n};\n\n//# sourceURL=webpack:///./partials/Giraff.js?");

/***/ }),

/***/ "./partials/Socials.js":
/*!*****************************!*\
  !*** ./partials/Socials.js ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = GRF_Soc;\nfunction GRF_Soc(stat) {\n    this.stat = stat;\n    this.sn_stat = [];\n    this.sn_count = 0;\n}\nGRF_Soc.prototype = {\n    run: function run(url) {\n        this.url = url;\n        this.url_enc = encodeURIComponent(this.url);\n\n        this.sn_count = 0;\n        var o = {};\n        try {\n            o = this.stat.parent.config.stats.socials;\n        } catch (e) {}\n\n        if (!o.no_fb) {\n            this.sn_count++;\n            this.get_fb();\n        }\n        if (!o.no_vk) {\n            this.sn_count++;\n            this.get_vk();\n        }\n        if (!o.no_ok) {\n            this.sn_count++;\n            this.get_ok();\n        }\n    },\n    load: function load(url) {\n        var s = document.createElement('script');\n        s.type = 'text/javascript';\n        s.async = true;\n        s.src = url;\n        var c = document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0];\n        c.appendChild(s);\n    },\n    send_stat: function send_stat(sn, cnt) {\n        this.sn_stat.push({ name: sn, count: cnt });\n        if (this.sn_stat.length >= this.sn_count) {\n            this.stat.set_social_stats(this.sn_stat);\n        }\n    },\n    get_fb: function get_fb() {\n        var that = this;\n        var callback_fb = '_grf_' + Math.random().toString().substr(2);\n        window[callback_fb] = function (data) {\n            var shares = 0;\n            try {\n                shares = data.share.share_count;\n            } catch (e) {}\n            that.send_stat('fb', shares);\n            window[callback_fb] = undefined;\n        };\n        this.load('https://graph.facebook.com/?id=' + this.url_enc + '&callback=' + callback_fb);\n    },\n    get_vk: function get_vk() {\n        var that = this;\n        var old = null;\n        var no_vk = !window.VK;\n        if (no_vk) {\n            window.VK = {};\n        }\n        var no_vk_share = !window.VK.Share;\n        if (no_vk_share) {\n            window.VK.Share = {};\n        }\n        var is_vk_share_count = !!window.VK.Share.count;\n        if (is_vk_share_count) {\n            old = window.VK.Share.count;\n        }\n        window.VK.Share.count = function (idx, cnt) {\n            that.send_stat('vk', cnt);\n            if (is_vk_share_count) {\n                window.VK.Share.count = old;\n            }\n            if (no_vk_share) {\n                window.VK.Share = undefined;\n            }\n            if (no_vk) {\n                window.VK = undefined;\n            }\n        };\n        this.load('https://vk.com/share.php?act=count&url=' + this.url_enc + '&index=0');\n    },\n    get_ok: function get_ok() {\n        var that = this;\n        var old = null;\n        var no_ok = !window.ODKL;\n        if (no_ok) {\n            window.ODKL = {};\n        }\n        var is_ok_count = !!window.ODKL.updateCount;\n        if (is_ok_count) {\n            old = window.ODKL.updateCount;\n        }\n        window.ODKL.updateCount = function (idx, cnt) {\n            that.send_stat('ok', cnt);\n            if (is_ok_count) {\n                window.ODKL.updateCount = old;\n            }\n            if (no_ok) {\n                window.ODKL = undefined;\n            }\n        };\n        this.load('https://connect.ok.ru/dk?st.cmd=extLike&uid=odklcnt0&ref=' + this.url_enc);\n    }\n};\n\n//# sourceURL=webpack:///./partials/Socials.js?");

/***/ }),

/***/ "./partials/Stats.js":
/*!***************************!*\
  !*** ./partials/Stats.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = GRF_Stats;\n\nvar _Socials = __webpack_require__(/*! ./Socials.js */ \"./partials/Socials.js\");\n\nvar _Socials2 = _interopRequireDefault(_Socials);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction GRF_Stats(config, parent) {\n    this.parent = parent;\n    this.reading_time = 0;\n    this.content_reading_time = 0;\n    this.page_visible = true;\n    this.max_scroll_percent = 0;\n    this.max_scroll_height = 0;\n    this.max_scroll_distance = false;\n    this.time_hash = new Date().getTime() + '.' + new Date().getMilliseconds();\n    this.already_added = [];\n    this.already_visited = [window.location.href];\n    this.last_page_position = 0;\n    this.pv_tags_sent = {};\n\n    this.config = config;\n    this.adblockDetected = this.config.adblockDetected;\n    this.name = this.config.name;\n    this.inactive = false;\n    this.active = false;\n    this.url_settings = this.config.url_settings;\n    this.url = null;\n    this.elem = null;\n    this.set_url(this.config.url);\n    this.is_vac = this.config.is_vac;\n    this.vis = this.config.vis;\n    this.ref = this.config.referrer;\n    this.ref_full = this.config.referrer_full;\n    this.version = this.config.version;\n    this.social_stats = null;\n\n    this.clear_stats = function () {\n        if (this.already_visited.indexOf(window.location.href) == -1 && this.last_page_position - (window.pageYOffset || document.documentElement.scrollTop) < 0) {\n            this.send_stat();\n            this.set_url(window.location.href);\n            this.already_visited.push(window.location.href);\n            this.last_page_position = document.body ? document.body.scrollTop : 0;\n            this.pv_tags_sent = {};\n            this.add_tracker();\n        }\n        this.content_depth = 0;\n        this.content_depth_percent = 0;\n        this.reading_time = 0;\n        this.content_reading_time = 0;\n        this.max_scroll_percent = 0;\n    };\n\n    this.soc_stat = new _Socials2.default(this);\n\n    if ('whotrades' == this.name || 'whotradesen' == this.name) {\n        els = document.getElementsByClassName('blog-post-item__content-wrapper');\n        if (els && els.length > 0) {\n            this.elem = els[0];\n        }\n    }\n\n    var that = this;\n    this.add_event(window, 'focus', function () {\n        that.page_visible = true;\n    });\n    this.add_event(window, 'blur', function () {\n        that.page_visible = false;\n    });\n    this.add_event(window, 'scroll', function () {\n        that.calc_scroll(that.elem);\n    });\n    this.add_event(window, 'load', function () {\n        that.calc_scroll(that.elem);\n    });\n    this.add_event(window, 'beforeunload', function () {\n        that.send_stat();\n    });\n\n    // получаем массив нужных блоков\n    this.arr = []; // массив, где будим хранить все блоки имеющиеся в DOM\n    this.arrWidgets = []; // массив, где будим хранить все виджеты имеющиеся в DOM\n    this.content_depth = 0;\n    this.content_depth_percent = 0;\n    this.content_selector = '.js-giraff-article';\n    this.widget_selector = 'grf_' + this.name + \"_\"; // id^=this.widget_selector\n\n    var callbackLoadListener = function callbackLoadListener() {\n        that.get_widgets(that.check_watch_widget());\n        that.get_blocks();\n        that.init_clicks();\n        that.init_check_depth();\n        that.observeDOM(document, function () {\n            that.get_widgets(that.check_watch_widget());\n            that.get_blocks();\n            that.init_clicks();\n            that.init_check_depth();\n        }, that.config);\n    };\n\n    this.add_event(window, 'resize', function () {\n        that.check_watch_widget();\n    });\n    this.add_event(window, 'scroll', function () {\n        that.check_watch_widget();\n        that.init_check_depth();\n    });\n\n    if (document.addEventListener) {\n        document.addEventListener('DOMContentLoaded', callbackLoadListener());\n    } else {\n        this.add_event(window, 'load', callbackLoadListener());\n    }\n};\nGRF_Stats.prototype = {\n    run: function run() {\n\n        this.add_tracker();\n\n        var that = this;\n        // setInterval(function() {that.init_clicks();}, 1000);\n        setInterval(function () {\n            that.calc_reading_time(that.elem);\n        }, 1000);\n        setInterval(function () {\n            that.calc_content_reading_time();\n        }, 1000);\n\n        setTimeout(function () {\n            that.soc_stat.run(that.url);\n        }, 200);\n    },\n    set_inactive: function set_inactive(value) {\n        this.inactive = value;\n    },\n    set_active: function set_active(value) {\n        this.active = value;\n    },\n    set_url: function set_url(url) {\n        if (this.url == url) {\n            return;\n        }\n        this.url = url;\n\n        this.reading_time = 0;\n        this.page_visible = true;\n        this.max_scroll_percent = 0;\n        this.max_scroll_height = 0;\n        this.max_scroll_distance = false;\n        this.time_hash = new Date().getTime() + '.' + new Date().getMilliseconds();\n    },\n    set_container: function set_container(elem) {\n        this.elem = elem;\n        this.reading_time = 0;\n        this.page_visible = true;\n        this.max_scroll_percent = 0;\n        this.max_scroll_height = 0;\n        this.max_scroll_distance = false;\n    },\n    add_event: function add_event(el, event, handler, check) {\n        if (check) {\n            if (this.already_added.indexOf(el) > -1) {\n                return;\n            }\n            this.already_added.push(el);\n        }\n        if (el.addEventListener) {\n            el.addEventListener(event, handler);\n        } else {\n            el.attachEvent('on' + event, handler);\n        }\n    },\n    element_offset_top: function element_offset_top(el) {\n        var box = el.getBoundingClientRect();\n\n        var scrollTop = window.pageYOffset || document.documentElement.scrollTop || (document.body ? document.body.scrollTop : 0);\n        var clientTop = document.documentElement.clientTop || document.body.clientTop || 0;\n        var top = box.top + scrollTop - clientTop;\n\n        return Math.round(top);\n    },\n    init_clicks: function init_clicks() {\n        if (window.giraff[this.config.name] && window.giraff[this.config.name].callbacks && window.giraff[this.config.name].callbacks.click) {\n            var that = this;\n            var links = document.getElementsByTagName('a');\n            for (var i = 0; i < links.length; i++) {\n                var link = links[i];\n                if (link.href && link.className && link.className.indexOf('grf-list__link') > -1) {\n                    this.add_event(link, 'click', function () {\n                        that.send_click();\n                    }, true);\n                }\n            }\n        }\n    },\n    calc_reading_time: function calc_reading_time(elem) {\n        this.page_visible = document.hidden !== undefined ? !document.hidden : this.page_visible;\n        if (this.page_visible) {\n            if (elem && this.max_scroll_distance) {\n                this.reading_time++;\n            } else if (!elem) {\n                this.reading_time++;\n            }\n        }\n    },\n    calc_scroll: function calc_scroll(elem) {\n        var current_scroll = (window.pageYOffset || document.documentElement.scrollTop) + document.documentElement.clientHeight - this.last_page_position;\n\n        var current_max_scroll_height;\n\n        if (elem) {\n            current_max_scroll_height = Math.max(elem.clientHeight, elem.scrollHeight, elem.offsetHeight);\n\n            var elem_offset_top = this.element_offset_top(elem);\n            this.max_scroll_distance = current_scroll >= elem_offset_top && elem_offset_top + current_max_scroll_height >= current_scroll;\n\n            current_scroll = this.max_scroll_distance ? current_scroll - elem_offset_top : 0;\n        } else {\n            current_max_scroll_height = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight, document.body.offsetHeight, document.documentElement.offsetHeight, document.body.clientHeight, document.documentElement.clientHeight);\n        }\n\n        var flag_recalc = current_max_scroll_height != this.max_scroll_height;\n        this.max_scroll_height = current_max_scroll_height;\n\n        var current_scroll_percent = Math.round(100 * current_scroll / this.max_scroll_height);\n\n        this.scroll_depth = current_scroll;\n\n        if (current_scroll_percent > this.max_scroll_percent || flag_recalc) {\n            this.max_scroll_percent = current_scroll_percent;\n        }\n        if (this.max_scroll_percent > 100) {\n            this.max_scroll_percent = 100;\n        }\n    },\n    observeDOM: function () {\n\n        var href = location.href;\n\n        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver,\n            eventListenerSupported = window.addEventListener;\n\n        return function (obj, callback, config) {\n            if (MutationObserver) {\n                var obs = new MutationObserver(function (mutations) {\n                    mutations.forEach(function () {\n                        callback();\n                    });\n                    if (href != location.href) {\n                        href = location.href;\n                        window.giraff[config.name].stats.clear_stats();\n                    }\n                });\n                obs.observe(obj, {\n                    childList: true,\n                    attributes: false,\n                    subtree: true,\n                    characterData: false\n                });\n            } else if (eventListenerSupported) {\n                obj.addEventListener('DOMNodeInserted', callback, false);\n                obj.addEventListener('DOMNodeRemoved', callback, false);\n            }\n        };\n    }(),\n    get_coords: function get_coords(elem) {\n        var box = elem.getBoundingClientRect();\n\n        var body = document.body;\n        var docEl = document.documentElement;\n\n        var scrollTop = window.pageYOffset || docEl.scrollTop || (body ? body.scrollTop : 0);\n\n        var clientTop = docEl.clientTop || body && body.clientTop || 0;\n\n        var top = box.top + scrollTop - clientTop;\n        var height = box.height;\n        var bottom = top + height;\n\n        return {\n            top: Math.round(top),\n            height: height,\n            bottom: Math.round(bottom),\n            watched: false,\n            el: elem\n        };\n    },\n    get_blocks: function get_blocks() {\n        this.blocks = document.querySelectorAll(this.content_selector);\n        if (this.blocks && this.blocks.length) {\n            for (var i = 0; i < this.blocks.length; i++) {\n                // если внутри блока контент загружается динамически, то высота блока будет 0, поэтому дождемся пока observe добавит потомков и выполнится условие\n                if (this.get_coords(this.blocks[i]).height != 0) {\n                    this.arr.push(this.get_coords(this.blocks[i]));\n                }\n            };\n        }\n    },\n    mutex_get_widgets: false,\n    get_widgets: function get_widgets(callback) {\n        if (this.mutex_get_widgets) return;\n        this.mutex_get_widgets = true;\n        var w_elements = document.querySelectorAll('[id^=\"' + this.widget_selector + '\"]');\n        for (var i = 0; i < w_elements.length; i++) {\n            var flag = true,\n                el = w_elements[i],\n                blockId = el.id.substring(this.widget_selector.length),\n                // убираем из id виджета \"grf_\" + имя площадки + \"_\"\n            blockNumber = blockId.substring(blockId.indexOf(\"_\"), -1);\n\n            for (var j = 0; j < this.arrWidgets.length; j++) {\n                if (this.arrWidgets[j].el == el) {\n                    flag = false;\n                    break;\n                }\n            }\n\n            if (flag) {\n                var coords = this.get_coords(el);\n                if (coords.height != 0 && blockId.indexOf(\"_\") > 0) {\n                    // Если блок прогрузился, то у него blockId будет типа \"1_1_1\", а если нет, то типа \"1\"\n                    this.arrWidgets.push([{ id: blockNumber }, coords].reduce(function (r, o) {\n                        Object.keys(o).forEach(function (k) {\n                            r[k] = o[k];\n                        });\n                        return r;\n                    }, {}));\n                }\n            }\n        }\n        this.mutex_get_widgets = false;\n\n        if (callback) callback();\n    },\n    check_visible_widget: function check_visible_widget() {\n        this.page_visible = document.hidden !== undefined ? !document.hidden : this.page_visible;\n        var tags = [];\n\n        if (this.page_visible) {\n            var cpTop = window.pageYOffset || document.documentElement.scrollTop || (document.body ? document.body.scrollTop : 0),\n                // верх экрана\n            cpBottom = cpTop + window.innerHeight; // низ экрана\n\n\n            // проверяем, есть ли виджеты попавшие на экран\n            for (var index = 0; index < this.arrWidgets.length; index++) {\n                if (this.arrWidgets[index].watched == false) {\n                    if (this.arrWidgets[index].top > cpTop & this.arrWidgets[index].top < cpBottom || this.arrWidgets[index].bottom < cpBottom && this.arrWidgets[index].bottom > cpTop || this.arrWidgets[index].bottom < cpBottom && this.arrWidgets[index].top > cpTop) {\n                        this.arrWidgets[index].watched = true;\n                        tags.push(\"ws_\" + this.arrWidgets[index].id);\n                        if (this.parent.widgets[this.arrWidgets[index].id - 1][\"on_show_tags\"]) {\n                            for (var i = 0; i < this.parent.widgets[this.arrWidgets[index].id - 1][\"on_show_tags\"].length; i++) {\n                                tags.push(this.parent.widgets[this.arrWidgets[index].id - 1][\"on_show_tags\"][i].replace(\"pv_\", \"wv_\") + \"_\" + this.arrWidgets[index].id);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return tags;\n    },\n    check_watch_widget: function check_watch_widget() {\n        var tags = this.check_visible_widget();\n        if (tags && tags.length) {\n            window.giraff[this.config.name].sendCustomTags(tags);\n        }\n    },\n    init_check_depth: function init_check_depth() {\n        if (this.arr && this.arr.length) {\n            // суммарная глубина нашего контента\n\n            // описываем сортировку по объектам в массиве. Сортируем по позиции top относительно страницы\n            var objSort = function objSort(a, b) {\n                if (a.top > b.top) return 1;\n                if (a.top < b.top) return -1;\n            };\n\n            var scrollTop = window.pageYOffset || document.documentElement.scrollTop || (document.body ? document.body.scrollTop : 0);\n            // считаем глубину\n            // определяем ключевые точки (область видимости пользователя на сайте), верх экрана и низ\n            var cpTop = scrollTop,\n                // верх экрана\n            cpBottom = cpTop + window.innerHeight; // низ экрана\n\n            var fullContentHeight = 0;\n            this.arr.sort(objSort);\n\n            // если блоки \"накладываются по глубине\", то объединим их\n            for (var i = 0; i < this.arr.length; i++) {\n                for (var j = i + 1; j < this.arr.length; j++) {\n                    // если блоки рядом друг с другом и одинаковой высоты\n                    if (this.arr[i].top == this.arr[j].top && this.arr[i].bottom == this.arr[j].bottom) {\n                        this.arr.splice(j, 1);\n                        i = 0;\n                    }\n                    // если блок i находится выше блока j, но верхняя точка блока j находится вышел нижней точки блока i\n                    else if (this.arr[i].top < this.arr[j].top && this.arr[i].bottom < this.arr[j].bottom && this.arr[i].bottom >= this.arr[j].top) {\n                            this.arr[i].bottom = this.arr[j].bottom;\n                            this.arr.splice(j, 1);\n                            i = 0;\n                        }\n                        // если блок i находится \"внутри\" блока j\n                        else if (this.arr[i].top == this.arr[j].top && this.arr[i].bottom < this.arr[j].bottom || this.arr[i].top > this.arr[j].top && this.arr[i].bottom == this.arr[j].bottom || this.arr[i].top > this.arr[j].top && this.arr[i].bottom < this.arr[j].bottom) {\n                                this.arr[i].bottom = this.arr[j].bottom;\n                                this.arr[i].top = this.arr[j].top;\n                                this.arr.splice(j, 1);\n                                i = 0;\n                            }\n                            // если блок j находится \"внутри\" блока i\n                            else if (this.arr[i].top == this.arr[j].top && this.arr[i].bottom > this.arr[j].bottom || this.arr[i].top < this.arr[j].top && this.arr[i].bottom == this.arr[j].bottom || this.arr[i].top < this.arr[j].top && this.arr[i].bottom > this.arr[j].bottom) {\n                                    this.arr.splice(j, 1);\n                                    i = 0;\n                                }\n                                // если блок i начался раньше чем закончился блок j, но закончился позже\n                                else if (this.arr[i].top > this.arr[j].top && this.arr[i].bottom > this.arr[j].bottom && this.arr[i].top <= this.arr[j].bottom) {\n                                        this.arr[i].top = this.arr[j].top;\n                                        this.arr.splice(j, 1);\n                                        i = 0;\n                                    }\n                }\n            }\n\n            // считаем глубину контента\n            this.arr.forEach(function (item) {\n                fullContentHeight += item.height;\n            });\n\n            this.sum_depth(cpTop, cpBottom);\n\n            if (fullContentHeight == 0) {\n                this.content_depth_percent = 0;\n            } else {\n                this.content_depth_percent = this.content_depth / fullContentHeight * 100;\n            }\n        }\n    },\n    sum_depth: function sum_depth(cpTop, cpBottom) {\n        var that = this;\n        this.arr.forEach(function (item) {\n            if (item.top < cpBottom && item.bottom <= cpBottom) {\n                if (item.watched == false) {\n                    // вычесть высоты всех с watched true\n                    var test_depth = that.content_depth;\n                    for (var j = 0; j < that.arr.length; j++) {\n                        if (that.arr[j].watched == true) {\n                            test_depth -= that.arr[j].height;\n                        }\n                    }\n                    // взять остаток и вычесть его из item.height\n                    test_depth = test_depth - item.height;\n\n                    // результат прибавить к depth и сделать watched true\n                    that.content_depth = that.content_depth - test_depth; // минус потому что переменная отрицательная\n                    item.watched = true;\n                }\n            } else if (item.top < cpBottom && item.bottom >= cpBottom && item.watched == false) {\n                // сумма высот всех просмотренных блоков\n                var c_depth = 0;\n                for (var k = 0; k < that.arr.length; k++) {\n                    if (that.arr[k].watched == true) {\n                        c_depth += that.arr[k].height;\n                    }\n                }\n\n                // высота просмотренной части блока\n                var diff = cpBottom - item.top;\n\n                // суммарная высота - это высота всех просмотренных блоков + высота части просматриваемового блока\n                if (diff && diff > 0) {\n                    that.content_depth = diff + c_depth;\n                }\n            }\n        });\n    },\n\n    // считывание времени чтения контента\n    calc_content_reading_time: function calc_content_reading_time() {\n        // проверим что странница активна\n        this.page_visible = document.hidden !== undefined ? !document.hidden : this.page_visible;\n        var status = 0; // статус того, что на экране есть нужный блок\n        if (this.page_visible) {\n            var scrollTop = window.pageYOffset || document.documentElement.scrollTop || (document.body ? document.body.scrollTop : 0);\n            var cpTop = scrollTop,\n                // верх экрана\n            cpBottom = cpTop + window.innerHeight; // низ экрана\n\n\n            // проверяем, есть ли блоки попавшие на экран\n            for (var index = 0; index < this.arr.length; index++) {\n                if (this.arr[index].top > cpTop & this.arr[index].top < cpBottom || this.arr[index].bottom < cpBottom && this.arr[index].bottom > cpTop || this.arr[index].bottom < cpBottom && this.arr[index].top > cpTop) {\n                    status = 1;\n                }\n            }\n\n            // если блок есть на экране, то счетчик времени увеличиваем.\n            if (status) {\n                this.content_reading_time++;\n            }\n        }\n    },\n\n    add_tracker: function add_tracker() {\n        var r = encodeURIComponent(this.ref_full);\n        var u = encodeURIComponent(this.url);\n\n        var sn = document.createElement('script');\n        sn.type = 'text/javascript';\n        sn.async = true;\n        var daurl = '//data.giraff.io/track/' + this.name + '.js?r=' + r + '&u=' + u + '&rand=' + Math.random() + '&v=' + this.version;\n        if (this.adblockDetected) {\n            daurl += '&ab=1';\n        }\n        if (this.is_vac) {\n            daurl += '&vac=1';\n        }\n        if (this.ref) {\n            daurl += '&ref=' + encodeURIComponent(this.ref);\n        }\n        if (this.vis) {\n            daurl += '&vis=1';\n        }\n        sn.src = daurl;\n        var c = document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0];\n        c.appendChild(sn);\n    },\n    send: function send(uri) {\n        var da_url = '//data.giraff.io' + uri;\n        try {\n            var xn = new (XMLHttpRequest || ActiveXObject)('MSXML2.XMLHTTP.3.0');\n            xn.open('GET', da_url, 1);\n            xn.withCredentials = true;\n            xn.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n            xn.send();\n        } catch (e) {}\n    },\n    send_tags: function send_tags(tags) {\n        var tag_str = typeof tags == 'string' ? tags : tags.join('&tag=');\n        if (!tags.length) return;\n        this.send('/hit/' + this.name + '?u=' + encodeURIComponent(this.url) + '&tag=' + tag_str + (this.ref ? '&ref=' + encodeURIComponent(this.ref) : '') + (this.adblockDetected ? '&ab=1' : '') + '&rand=' + Math.random());\n    },\n    send_pv_tags: function send_pv_tags(pv_tags) {\n        var filtered = [];\n        for (var i = 0; i < pv_tags.length; i++) {\n            var t = pv_tags[i];\n            if (!this.pv_tags_sent[t]) {\n                this.pv_tags_sent[t] = true;\n                filtered.push(t);\n            }\n        }\n        if (filtered.length) {\n            this.send_tags(filtered);\n        }\n    },\n    send_click: function send_click() {\n        if (window.giraff[this.config.name] && window.giraff[this.config.name].callbacks && window.giraff[this.config.name].callbacks.click) {\n            window.giraff[this.config.name].callbacks.click();\n        }\n    },\n    send_stat: function send_stat() {\n        var crt = this.arr && this.arr.length ? this.content_reading_time : this.reading_time;\n        var csd = this.arr && this.arr.length ? this.content_depth_percent : this.max_scroll_percent;\n        this.send('/reading/' + this.name + '/?rt=' + this.reading_time + '&sd=' + this.max_scroll_percent + '&crt=' + crt + '&csd=' + csd + '&time=' + this.time_hash + '&u=' + encodeURIComponent(this.url) + (this.ref ? '&ref=' + encodeURIComponent(this.ref) : '') + (this.social_stats ? '&' + this.social_stats.join('&') : '') + '&rand=' + Math.random());\n    },\n    set_social_stats: function set_social_stats(sn_stat) {\n        if (!sn_stat.length) {\n            return;\n        }\n        var params = [];\n        var total_shares = 0;\n        for (var i = 0; i < sn_stat.length; i++) {\n            params.push(sn_stat[i].name + '=' + sn_stat[i].count);\n            total_shares += parseInt(sn_stat[i].count);\n        }\n        if (total_shares) {\n            this.social_stats = params;\n        }\n    }\n};\n\n//# sourceURL=webpack:///./partials/Stats.js?");

/***/ }),

/***/ "./partials/jsonp.js":
/*!***************************!*\
  !*** ./partials/jsonp.js ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = GRF_JSONP;\nfunction GRF_JSONP(src, options) {\n    var options = options || {},\n        callback_name = options.callbackName || 'callback' + (Math.random() + \"\").substr(2),\n        on_success = options.onSuccess || function () {},\n        on_timeout = options.onTimeout || function () {},\n        on_error = options.onError || function () {},\n        timeout = options.timeout || 10;\n\n    src += '&callback=' + callback_name;\n\n    var timeout_trigger = window.setTimeout(function () {\n        window[callback_name] = function () {};\n        on_timeout();\n    }, timeout * 1000);\n\n    window[callback_name] = function (data) {\n        window.clearTimeout(timeout_trigger);\n        if (data[0] && data[0].slot && data[0].html) {\n            eval(data[0].html);\n        } else {\n            on_success(data);\n        }\n    };\n\n    var script = document.createElement('script');\n    var head = document.getElementsByTagName('head')[0];\n    script.type = 'text/javascript';\n    script.async = true;\n    script.src = src;\n    script.onload = function () {\n        head.removeChild(this);\n    };\n    script.onerror = function () {\n        on_error();\n    };\n    head.appendChild(script);\n};\n\n//# sourceURL=webpack:///./partials/jsonp.js?");

/***/ })

/******/ });